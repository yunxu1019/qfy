02ydata,Date,extend,enrich,Function,encode62,h,i,k,l,m,dvar e='userinfo',f=h.getInstance(e),j={name:'',_id:'',_passport:'',avatar:null,isLogin:!1,roles:null},c,g,a={targetUrl:null,loginPath:null,session_time:3e5,session:'',loadSession:function(){var b=f;return b.session&&!(new i>b.session_time)&&(a.session_time=b.session_time,a.session=b.session,this.Login(b)),b.session||''},saveSession:function(b){b===void 0&&(b=this.session),this.session=b,h.setInstance(e,{roles:a.roles,name:a.name,_id:a._id,session:b,_passport:this._passport,isLogin:!!b,session_time:+new i+a.session_time})},Login:function(a){this.login(a)},Logout:function(){this.logout()}};k(a,j,f);var b=l(a);return b.setLoginPath=function(b){a.loginPath=b},b.setUserDataLoader=function(a){g=a},b.setSessionTime=function(b){a.session_time=b},b.refresh=function(){g instanceof m&&g()},b.getPassport=function(){return c||(c=d.timeencode(d.decode62(b._passport,b.session))),c=d.timeupdate(c)},b.login=function(c){a.roles=c.roles||[],a.isLogin=!0,a.name=c.name,a._id='org.couchdb.user:'+c.name,b.clean&&b.clean(a.loginPath),this.refresh()},b.logout=function(){delete b.isLogin,delete b.roles,delete b._passport,a._passport='',a.roles=null,a.isLogin=!1,c='',this.saveSession('')},b